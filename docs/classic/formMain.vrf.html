<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>formMain.vrf.annotated</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>formMain.vrf.annotated</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p><a href="https://github.com/ASNA/classic-dotnet-navgrid">Return to repo</a></p>
<h3>AVR Classic program to demonstrate a simple subfile for customer selection.</h3>
<h4><a href="formMain.vrf.controls.html">Show controls list and their properties.</a></h4>
<p><a href="http://1clickurls.com/yT1m-Mq">See file schema here.</a></p>
<p><img alt="" src="screen-shot-01.png?4" /><br>
<small>The subfile display</small></p>
<p><img alt="" src="screen-shot-02.png?4" /><br>
<small>The update panel</small></p>
<p>This program shows a simple page-at-a-time subfile that would be used 
for navigation through a file. Once a row is located, the user would initiate 
an action. That action isn't shown in the is example; this example focuses on 
populating and navigating the subfile. 
disabled: 90, 88, 89
backcolor: 195, 195, 195</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>Files opened for update aren't blocked like input files are. Therefore it's always best
to use input files (which are blocked by default with AVR) for populating lists
(such as subfiles and comboboxes). 
The <code>Prefix</code> is a bit of a hack that provides fully-qualified field names.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclDiskFile</span>  <span class="nx">Name</span><span class="p">(</span><span class="nx">Cust</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">INPUT</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Org</span><span class="p">(</span><span class="o">*</span><span class="nx">INDEXED</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Prefix</span><span class="p">(</span><span class="nx">Cust_</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">NetBlockFactor</span><span class="p">(</span><span class="o">*</span><span class="nx">Calc</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">AddRec</span><span class="p">(</span><span class="o">*</span><span class="nx">No</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">FileDesc</span><span class="p">(</span><span class="s1">&#39;Examples/CMastNewL2&#39;</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">DBDesc</span><span class="p">(</span><span class="s1">&#39;*PUBLIC/DG NET Local&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>This file is opened for update. When reads are made against this file that aren't 
followed with a (nearly) immediate write, the <code>Unlock</code> opcode is used to unlock the record.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclDiskFile</span>  <span class="nx">Name</span><span class="p">(</span><span class="nx">CustUpdate</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Update</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Org</span><span class="p">(</span><span class="o">*</span><span class="nx">INDEXED</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Prefix</span><span class="p">(</span><span class="nx">Cust_</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">RnmFmt</span><span class="p">(</span><span class="nx">CUSTU</span><span class="p">)</span> <span class="o">+</span> 
             <span class="nx">FileDesc</span><span class="p">(</span><span class="s1">&#39;Examples/CMastNewL1&#39;</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">DBDesc</span><span class="p">(</span><span class="s1">&#39;*PUBLIC/DG Net Local&#39;</span><span class="p">)</span>

<span class="c1">// These data structures aren&#39;t used in this program, but provide a </span>
<span class="c1">// potential discussion point.  </span>
<span class="c1">// DclDS CustDS  ExtDesc(*Yes) +</span>
<span class="c1">//               FileDesc(&#39;Examples/CMastNewL2&#39;) +</span>
<span class="c1">//               DBDesc(&#39;*PUBLIC/DG NET Local&#39;) +</span>
<span class="c1">//               Prefix(Cust_)</span>
 
<span class="c1">// DclDS sbfCustDS  ExtDesc(*Yes) +</span>
<span class="c1">//                  FileDesc(&#39;Examples/CMastNewL2&#39;) +</span>
<span class="c1">//                  DBDesc(&#39;*PUBLIC/DG NET Local&#39;) +</span>
<span class="c1">//                 Prefix(SbfCust_)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>This constant controls how many rows are presented
in the subfile.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclConst</span> <span class="nx">SUBFILE_ROWS</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>This constant idenfies the (zero-based) first row in the subfile.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclConst</span> <span class="nx">TOP_ROW</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> 

<span class="nx">DclConst</span> <span class="nx">REFRESH_FROM_FIRST_ROW</span> <span class="nx">Value</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Labels on forms that have empty captions are very hard to work with
at designtime. I add bracketed captions to these labels so that they 
are easy to work with at runtime (for example, <code>[Name]</code>). When the 
program starts these labels are cleared. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">labelName</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="nx">labelAddress</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="nx">labelCSZ</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Show first page of the subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">sbfCust_ShowFirstPage</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>End of mainline.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Naming conventions:</p>
<ul>
<li><strong>sbfCust.[method name]:</strong> Methods provided intrinsically by the subfile.</li>
<li><strong>sbfCust.[property name]:</strong> Properties provided intrinsically by the subfile.</li>
<li><strong>sbfCust_[method name]:</strong> Methods that manipulate the subfile provided in this program.</li>
<li><strong>sbfCust_[field name]:</strong> Fields that describe or control the subfile provided in this program.</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Notes:</p>
<ul>
<li>Set sbfCust.Browse to False to be able to edit a subfile row in place. Note that 
sbfCust.Browse is a design-time property only--you can't change it at runtime.   </li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>First page requested.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageFirstPage</span> <span class="nx">Click</span>
    <span class="nx">sbfCust_ShowFirstPage</span><span class="p">()</span> 
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Next page requested.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageNextPage</span> <span class="nx">Click</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Read the last populated row of the subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Move the file pointer to next record after the one
in the last row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetGT</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Show the next page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowPage</span><span class="p">()</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Previous page requested. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imagePreviousPage</span> <span class="nx">Click</span>       
    <span class="nx">sbfCust_ShowPreviousPage</span><span class="p">()</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Last page requested. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageLastPage</span> <span class="nx">Click</span>
    <span class="nx">sbfCust_ShowLastPage</span><span class="p">()</span>  
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Refresh subfile from top row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageRefresh</span> <span class="nx">Click</span>
    <span class="nx">sbfCust_Refresh</span><span class="p">(</span><span class="nx">TOP_ROW</span><span class="p">)</span> 
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Toggle refresh image to show mouse down.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageRefresh</span> <span class="nx">MouseDown</span>
    <span class="nx">DclSrParm</span> <span class="nx">Button</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Shift</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">X</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Y</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;refresh-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageRefresh</span><span class="p">)</span> 
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Toggle refresh image to show mouse up.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageRefresh</span> <span class="nx">MouseUp</span>
    <span class="nx">DclSrParm</span> <span class="nx">Button</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Shift</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">X</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Y</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;refresh.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageRefresh</span><span class="p">)</span> 
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Watch for ENTER key in the textboxPositionTo textbox. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">textboxPositionTo</span> <span class="nx">KeyPress</span>
    <span class="nx">DclSrParm</span> <span class="nx">KeyAscii</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nx">BY</span><span class="p">(</span><span class="o">*</span><span class="nx">REFERENCE</span><span class="p">)</span>
 
    <span class="nx">DclConst</span> <span class="nx">ENTER_KEY</span> <span class="nx">Value</span><span class="p">(</span> <span class="mi">13</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">EAT_KEY</span>   <span class="nx">Value</span><span class="p">(</span>  <span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Watch for an Enter keypress when ioPosition has 
focus. End the keypress event handler by setting 
KeyAscii to EAT_KEY (0) and then position the subfile.<br />
EAT_KEY keeps the Windows event loop from further 
processing this keypress.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">ENTER_KEY</span><span class="p">)</span>
        <span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">EAT_KEY</span>
        <span class="nx">sbfCust_PositionTo</span><span class="p">(</span><span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
        <span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">Value</span> <span class="o">=</span> <span class="o">*</span><span class="nx">Blanks</span>
    <span class="nx">EndIf</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>The current row changed in the subfile with either the 
arrow keys, the mouse cursor, or programatically.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust</span> <span class="nx">RecSwitch</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>FromRec is the zero-based row number from which the subfile is switching.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">DclSrParm</span> <span class="nx">FromRec</span>  <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Each time a row position is changed the customer info panel at the
top left of the screen is refreshed with customer info for the 
current subfile record. 
AVR Classic's subfile reports zero-based Row and Col properties, but the 
subfile RRN is one based. 
When chaining to the subfile with the subfile Row property, be sure to add 
one to it to 'translate' it to the corresponding one-based RRN.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">NotFnd</span><span class="p">(</span><span class="o">*</span><span class="nx">In50</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Populate customer info panel with fields from the 
just-read subfile row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_SetInfoDisplay</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>This subfile event handler fires as the subfile row is changing.
The subfile heading is a considered a row, just like the data rows. 
The subfile heading row's ordinal position is -1 and the first data row 
is zero. If the user moves the current row the entire subfile is 
selected and that is very jarring to the user. This code looks to see 
if the user attempted to move into the header and moves the row 
selected back to the twop row (the zeroth row).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust</span> <span class="nx">SelChanging</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Inhibit user moving to heading row of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">DclConst</span>  <span class="nx">HEADING_ROW</span>   <span class="nx">Value</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Uncomment this LeaveSr and user move the row to the top of the 
subfile with the <code>up</code> arrow key to see the default behavior arrow
key behavior.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span> <span class="o">=</span> <span class="nx">HEADING_ROW</span><span class="p">)</span>
        <span class="nx">sbfCust_GoToRow</span><span class="p">(</span><span class="nx">TOP_ROW</span><span class="p">)</span>
    <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>The subfile header is row -1 (go figure!) and that means that
at initial program startup subCust.SelStartRow can be less than 
zero. Leave this routine is that's the case.     </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartRow</span> <span class="o">&lt;</span> <span class="mi">0</span> 
        <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
        <span class="nx">LeaveSr</span>
    <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>The SelChanging event fires when the user moves the subfile to another 
row. The subfile.Row property reports the zero-based row the user is 
moving to (the target row), and the subfile.SelStartRow property reports
the zero-based row the user is moving from (the source row).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>If the source row was changed attempt record edit. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecChanged</span><span class="p">[</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartRow</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Read the changed row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartRow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Check for errors here. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">If</span> <span class="nx">ValidateInputForCustomer</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Attempt file update.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">UpdateCustomer</span><span class="p">(</span><span class="nx">sbfCust_CMCustNo</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Show message.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">SetMessageText</span><span class="p">(</span><span class="s1">&#39;Customer changed: &#39;</span> <span class="o">+</span> <span class="o">%</span><span class="nx">CHAR</span><span class="p">(</span><span class="o">%</span><span class="nx">EDITC</span><span class="p">(</span><span class="nx">sbfCust_CMCustNo</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Set row RecChanged status to false.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecChanged</span><span class="p">[</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartRow</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Position to the customer name.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust_PositionTo</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span>
        <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>If there was a validation error, move back to the 
source row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartRow</span>  
            <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Col</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SelStartCol</span>
        <span class="nx">EndIf</span> 
    <span class="nx">ENdIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>Give the subfile focus.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Double-click on a subfile row to select it for update.     </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">sbfCust</span> <span class="nx">DoubleClick</span>
    <span class="nx">CustomerUpdateWithForm</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Clear the subfile and set its RRN to zero--making it ready for a 
a new page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_Initialize</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Initialize and clear subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_RRN</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">ClearObj</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>Show first page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowFirstPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Position file at top of file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="o">*</span><span class="nx">Start</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Show the subfile page.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowPage</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>Show a page of subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Fill sbfCust with next group of rows from Cust's current 
file pointer position. This subroutine is called by all 
other page operations (first, previous, next, and last) 
to populate the subfile.
Having this one routine to populate the subfile provides 
one place where all of the housekeeping needed after 
writing a page to the subfile can be done. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>Clear the subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_Initialize</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>This is a page-at-a-time subfile. The SUBFILE_ROWS constants
defines how many rows are written to the subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Do</span> <span class="nx">FromVal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="nx">ToVal</span><span class="p">(</span><span class="nx">SUBFILE_ROWS</span><span class="p">)</span>
        <span class="nx">Read</span> <span class="nx">Cust</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>If %EOF(Cust) then you've run out of records to 
put in the subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">If</span> <span class="p">(</span><span class="o">%</span><span class="nx">EOF</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span>
            <span class="nx">Leave</span>
        <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <p>Increment the subfile RRN property.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_RRN</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span> <span class="o">+</span> <span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      <p>Assign fields to the subfile from the just-read 
recoord format. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_AssignFields</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <p>Write the subfile row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Write</span> <span class="nx">sbfCust</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      <p>Zebra stripe the subfile.             </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">SetRowColor</span><span class="p">(</span><span class="nx">sbfCust_RRN</span><span class="p">)</span>
    <span class="nx">EndDo</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <p>Set the enabled/disabled status of the 
image buttons. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLeftButtonsStatus</span><span class="p">(</span><span class="nx">MoreRecordsBack</span><span class="p">())</span>
    <span class="nx">SetRightButtonsStatus</span><span class="p">(</span><span class="nx">MoreRecordsForward</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      <p>Explicitly set the subfile to top row (which
implicitly refreshes the customer info
at the top of the form.)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_GoToRow</span><span class="p">(</span><span class="nx">TOP_ROW</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>Give focus to the subfile so its speed keys are in effect.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      <p>Show previous page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowPreviousPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      <p>Read the first row of the subfile to make that row's fields available.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <p>Position the file at the record in the first row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>Read backwards from there. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">ReadCustOnePageBackwards</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <p>Having read backwards a number of rows and then 
show the page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowPage</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      <p>Show last page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowLastPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      <p>Position file pointer at end of file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetGT</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="o">*</span><span class="nx">HiVal</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      <p>Read backwards from there. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">ReadCustOnePageBackwards</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      <p>Having read backwards a number of rows and then 
show the page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowPage</span><span class="p">()</span>
<span class="nx">EndSr</span> 

<span class="nx">BegSr</span> <span class="nx">sbfCust_AssignFields</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <p>Assign fields from the Cust file to the subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_CMCustNo</span> <span class="o">=</span> <span class="nx">Cust_CMCustNo</span> 
    <span class="nx">sbfCust_CMName</span> <span class="o">=</span> <span class="nx">Cust_CMName</span>
    <span class="nx">sbfCust_CMAddr1</span> <span class="o">=</span> <span class="nx">Cust_CMAddr1</span>
    <span class="nx">sbfCust_CMCity</span> <span class="o">=</span> <span class="nx">Cust_CMCity</span>
    <span class="nx">sbfCust_CMState</span> <span class="o">=</span> <span class="nx">Cust_CMState</span>
    <span class="nx">sbfCust_CMPostCode</span> <span class="o">=</span> <span class="nx">Cust_CMPostCode</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      <p>Position populated subfile at top row (the zeroth row). </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_GoToRow</span>
    <span class="nx">DclSrParm</span> <span class="nx">TargetRow</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">DclConst</span> <span class="nx">LEFT_MOST_COLUMN</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      <p>The Select method selects the given row of the subfile. 
If there are no rows in the subfile, the Select method
fails. Wrapping it an Eval statement and using 
Err(*Extended) 'eats' the error letting Select method 
fail silently. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      <p>You need to provide a zero-based row and column to the 
Select method. Zero is the top row and zero is the left-most 
column. Constants are used to avoid using "magic numbers" 
that be confusing later. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Eval</span> <span class="nx">F2</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Select</span><span class="p">(</span><span class="nx">TargetRow</span><span class="p">,</span> <span class="nx">LEFT_MOST_COLUMN</span><span class="p">))</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      <p>Position subfile at a new location. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">sbfCust_PositionTo</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">PositionToName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      <p>DclFld SaveName Type(*String) </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-76'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-76'>#</a>
      </div>
      <p>Is position-to value key in the file</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">PositionToName</span><span class="p">)</span>
    <span class="nx">If</span> <span class="p">(</span><span class="o">%</span><span class="nx">FOUND</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-77'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-77'>#</a>
      </div>
      <p>If so, show the next page from there.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_ShowPage</span><span class="p">()</span>        
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-78'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-78'>#</a>
      </div>
      <p>Otherwise, reselect the subfile's top row and 
display a message. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_GoToRow</span><span class="p">(</span><span class="nx">TOP_ROW</span><span class="p">)</span>        
        <span class="nx">MsgBox</span> <span class="nx">Title</span><span class="p">(</span><span class="s1">&#39;Search results&#39;</span><span class="p">)</span> <span class="nx">Msg</span><span class="p">(</span><span class="s1">&#39;No records found&#39;</span><span class="p">)</span>
        <span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span> 
    <span class="nx">EndIf</span>
<span class="nx">EndFunc</span> 

<span class="nx">BegSr</span> <span class="nx">sbfCust_SetFields</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-79'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-79'>#</a>
      </div>
      <p>Move fields from disk file to subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-80'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-80'>#</a>
      </div>
      <p>Assign field values for customer info panel 
above the subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_SetInfoDisplay</span>    
    <span class="nx">labelName</span><span class="p">.</span><span class="nx">Caption</span>      <span class="o">=</span> <span class="nx">sbfCust_CMName</span>
    <span class="nx">labelAddress</span><span class="p">.</span><span class="nx">Caption</span>   <span class="o">=</span> <span class="nx">sbfCust_CMAddr1</span>
    <span class="nx">labelCSZ</span><span class="p">.</span><span class="nx">Caption</span>       <span class="o">=</span> <span class="o">%</span><span class="nx">TRIM</span><span class="p">(</span><span class="nx">sbfCust_CMCity</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">++</span>
                             <span class="nx">sbfCust_CMState</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span> <span class="o">++</span>
                             <span class="nx">sbfCust_CMPostCode</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-81'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-81'>#</a>
      </div>
      <p>Refresh the subfile from a given name.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_Refresh</span>
    <span class="nx">DclSrParm</span> <span class="nx">CMName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 

    <span class="nx">DclFld</span> <span class="nx">SaveRow</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-82'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-82'>#</a>
      </div>
      <p>Save the current subfile row for repositioning 
back to this row after refreshing. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SaveRow</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-83'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-83'>#</a>
      </div>
      <p>If the name passed is blanks, then refresh from 
the subfile's first record.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">CMName</span> <span class="o">=</span> <span class="nx">REFRESH_FROM_FIRST_ROW</span>
        <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
        <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span>         
    <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-84'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-84'>#</a>
      </div>
      <p>If a name is provided, refresh from that name. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">CMName</span><span class="p">)</span>             
    <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-85'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-85'>#</a>
      </div>
      <p>Show the page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowPage</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-86'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-86'>#</a>
      </div>
      <p>Put the selected row back where it was. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_GoToRow</span><span class="p">(</span><span class="nx">SaveRow</span><span class="p">)</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-87'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-87'>#</a>
      </div>
      <p>Poll for 'f', 'p', 'n', and 'l' keypresses to behave as accelerator keys 
for the corresponding subfile page actions. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">sbfCust</span> <span class="nx">KeyPress</span>
    <span class="nx">DclSrParm</span> <span class="nx">KeyAscii</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nx">BY</span><span class="p">(</span><span class="o">*</span><span class="nx">REFERENCE</span><span class="p">)</span>

    <span class="nx">DclConst</span> <span class="nx">ESCAPE_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>   
    <span class="nx">DclConst</span> <span class="nx">LOWER_F_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_N_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_P_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">112</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_L_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">108</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-88'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-88'>#</a>
      </div>
      <p>The escape key cancels an inline row edit.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">ESCAPE_KEY</span>         
        <span class="nx">sbfCust_Refresh</span><span class="p">(</span><span class="nx">REFRESH_FROM_FIRST_ROW</span><span class="p">)</span> 
    <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-89'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-89'>#</a>
      </div>
      <p>The subfile's Browse property controls where the subfile 
is browse-only (as opposed to being editable. If it is editable,
leave the subroutine now because the speed keys don't work with
an editable subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Browse</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span> 
        <span class="nx">LeaveSr</span>
    <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-90'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-90'>#</a>
      </div>
      <p>Speed keys for subfile navigation. Note the subfile needs 
to be focused for these to work. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_F_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowFirstPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_P_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowPreviousPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_N_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_L_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowLastPage</span><span class="p">)</span> 
    <span class="nx">EndCs</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-91'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-91'>#</a>
      </div>
      <p>Set the first and previous page buttons' enabled status. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetLeftButtonsStatus</span>
    <span class="nx">DclSrParm</span> <span class="nx">Enabled</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-92'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-92'>#</a>
      </div>
      <p>AVR Classic doesn't have an image button. This program uses the 
image control to simulate image buttons. This is a little extra
work because you need enabled and disabled images, but it 
removes dependence on a third-party button control. See the 
note at the bottom of this page to read about a way to create images
for this purpose.     </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">Enabled</span><span class="p">)</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-end-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageFirstPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imagePreviousPage</span><span class="p">)</span> 
        <span class="nx">imageFirstPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">imagePreviousPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-end-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageFirstPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imagePreviousPage</span><span class="p">)</span> 
        <span class="nx">imageFirstPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
        <span class="nx">imagePreviousPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
    <span class="nx">EndIf</span>  
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-93'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-93'>#</a>
      </div>
      <p>Set next and last page buttons' enabled status. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetRightButtonsStatus</span>
    <span class="nx">DclSrParm</span> <span class="nx">Enabled</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    
    <span class="nx">If</span> <span class="p">(</span><span class="nx">Enabled</span><span class="p">)</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-end-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageLastPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageNextPage</span><span class="p">)</span> 
        <span class="nx">imageLastPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">imageNextPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-end-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageLastPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageNextPage</span><span class="p">)</span> 
        <span class="nx">imageLastPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
        <span class="nx">imageNextPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span> 
    <span class="nx">EndIf</span>  
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-94'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-94'>#</a>
      </div>
      <p>Update the customer record from the currently editable row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">UpdateCustomer</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">CustomerNumber</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">Chain</span> <span class="nx">CustUpdate</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">CustomerNumber</span><span class="p">)</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span> 
    <span class="nx">If</span> <span class="o">%</span><span class="nx">Found</span><span class="p">()</span> 
        <span class="nx">Cust_CMName</span> <span class="o">=</span> <span class="nx">sbfCust_CMName</span>
        <span class="nx">Cust_CMAddr1</span> <span class="o">=</span> <span class="nx">sbfCust_CMAddr1</span>
        <span class="nx">Update</span> <span class="nx">CustUpdate</span>    
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">True</span>
    <span class="nx">Else</span> 
        <span class="nx">Unlock</span> <span class="nx">CustUpdate</span>
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span>
    <span class="nx">EndIf</span>
<span class="nx">EndFunc</span> 

<span class="nx">BegFunc</span> <span class="nx">ValidateInputForCustomer</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span>
    <span class="nx">DclFld</span> <span class="nx">Valid</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span>

    <span class="nx">If</span> <span class="nx">sbfCust_CMName</span> <span class="o">=</span> <span class="o">*</span><span class="nx">Blanks</span>  
        <span class="nx">SetMessageText</span><span class="p">(</span><span class="s1">&#39;Please enter a name&#39;</span><span class="p">)</span>
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span>
    <span class="nx">EndIf</span> 

    <span class="nx">If</span> <span class="nx">sbfCust_CMAddr1</span> <span class="o">=</span> <span class="o">*</span><span class="nx">Blanks</span>  
        <span class="nx">SetMessageText</span><span class="p">(</span><span class="s1">&#39;Please enter an address&#39;</span><span class="p">)</span>
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span>
    <span class="nx">EndIf</span> 

    <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">True</span> 
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-95'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-95'>#</a>
      </div>
      <p>Every page (first, previous, next, and last) are displayed 
with the sbfCust_ShowNextPage routine. To page through the 
file backwards, this routine reads backwards through the file 
SUBFILE_ROWS + 1 rows. It does this to position the file 
pointer so that sbfCust_ShowNextPage displays the correct page.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">ReadCustOnePageBackwards</span>
    <span class="nx">DclFld</span> <span class="nx">BegOfFile</span>  <span class="nx">Type</span><span class="p">(</span> <span class="o">*</span><span class="nb">Boolean</span> <span class="p">)</span>

    <span class="nx">Do</span> <span class="nx">FromVal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="nx">ToVal</span><span class="p">(</span><span class="nx">SUBFILE_ROWS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nx">ReadP</span> <span class="nx">Cust</span> <span class="nx">BOF</span><span class="p">(</span><span class="nx">BegOfFile</span><span class="p">)</span>
        <span class="nx">If</span> <span class="nx">BegOfFile</span>
            <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="o">*</span><span class="nx">Start</span><span class="p">)</span> 
        <span class="nx">EndIf</span>
    <span class="nx">EndDo</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-96'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-96'>#</a>
      </div>
      <p>Set subfile row color.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetRowColor</span> 
    <span class="nx">DclSrParm</span> <span class="nx">SubfileRRN</span>   <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="nx">DclFld</span> <span class="nx">SubfileRow</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-97'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-97'>#</a>
      </div>
      <p>The RRN is one-based--so adjust to zero-based to 
reference a subfile row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SubfileRow</span> <span class="o">=</span> <span class="nx">SubfileRRN</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="nx">If</span> <span class="nx">IsEven</span><span class="p">(</span><span class="nx">SubfileRow</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-98'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-98'>#</a>
      </div>
      <p>The labelEvenRowColor and labelOddRowColor are purely for 
the convenience of setting </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecBackColor</span><span class="p">[</span><span class="nx">SubfileRow</span><span class="p">]</span> <span class="o">=</span> <span class="nx">labelEvenRowColor</span><span class="p">.</span><span class="nx">BackColor</span>
    <span class="nx">Else</span>
        <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecBackColor</span><span class="p">[</span><span class="nx">SubfileRow</span><span class="p">]</span> <span class="o">=</span> <span class="nx">labelOddRowColor</span><span class="p">.</span><span class="nx">BackColor</span>
    <span class="nx">EndIf</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-99'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-99'>#</a>
      </div>
      <p>Return remainder of integer division.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">IsEven</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Value</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">DclConst</span> <span class="nx">EVEN_DIVISOR</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 

    <span class="nx">LeaveSr</span> <span class="nx">Value</span><span class="p">(</span><span class="o">%</span><span class="nx">REM</span><span class="p">(</span><span class="nx">Value</span><span class="p">,</span> <span class="nx">EVEN_DIVISOR</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-100'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-100'>#</a>
      </div>
      <p>Return true if there are more records backward, given the 
key value on the first row displayed. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">MoreRecordsBack</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  
    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> 
    <span class="nx">ReadP</span> <span class="nx">Cust</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span> 
   
    <span class="nx">LeaveSr</span> <span class="nx">Value</span><span class="p">(</span><span class="nx">NOT</span> <span class="o">%</span><span class="nx">EOF</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span> 
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-101'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-101'>#</a>
      </div>
      <p>Return true if there are more records forward, given the 
key value on the last row displayed. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">MoreRecordsForward</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span><span class="p">)</span>  
    <span class="nx">SetGT</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> 
    <span class="nx">LeaveSr</span> <span class="o">%</span><span class="nx">Found</span><span class="p">(</span><span class="nx">Cust</span><span class="p">)</span> 
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-102'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-102'>#</a>
      </div>
      <p>Set the labelMessage control's <code>Caption</code> property and enable 
the timerMessage timer control. When it expires the message is cleared. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetMessageText</span>
    <span class="nx">DclSrParm</span> <span class="nx">Text</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 

    <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="nx">Text</span> 
    <span class="nx">timerMessage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-103'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-103'>#</a>
      </div>
      <p>This event handler fires when the timerMessage control's interval (its 
elaspsed time in milliseconds). This clears the labelMessage control's caption.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">timerMessage</span> <span class="nx">Timer</span>
    <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="nx">timerMessage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>  
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-104'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-104'>#</a>
      </div>
      <p>Compare a given name to the name on the given row of the subfile. This is used to 
determine if the subfile needs to move rows if a name is updated in place. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">CompareNameToSubfileRowName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">RRN</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">CMName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 

    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">RRN</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-105'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-105'>#</a>
      </div>
      <p>Note how the return value is the result of the boolean expression.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">LeaveSr</span> <span class="nx">Value</span><span class="p">(</span><span class="nx">sbfCust_CMname</span> <span class="o">=</span> <span class="nx">CMName</span><span class="p">)</span>
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-106'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-106'>#</a>
      </div>
      <p>Call form to update customer. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">CustomerUpdateWithForm</span>
    <span class="nx">DclFld</span> <span class="nx">CMName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Char</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> 
    <span class="nx">DclFld</span> <span class="nx">Updated</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Char</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
    <span class="nx">DclFld</span> <span class="nx">CurrentRow</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-107'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-107'>#</a>
      </div>
      <p>Save the current subfile row to restore the row 
position after the update operation. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">CurrentRow</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-108'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-108'>#</a>
      </div>
      <p>Call the form passing it three parameters (which are passed 
by reference).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Call</span> <span class="nx">pgm</span><span class="p">(</span><span class="s1">&#39;formCustCRUD&#39;</span><span class="p">)</span> 
        <span class="nx">DclParm</span> <span class="nx">sbfCust_CMCustNo</span> 
        <span class="nx">DclParm</span> <span class="nx">CMName</span>
        <span class="nx">DclParm</span> <span class="nx">Updated</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-109'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-109'>#</a>
      </div>
      <p>If an update was performed with the form...</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="nx">Updated</span> <span class="o">=</span> <span class="nx">RECORD_UPDATED</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-110'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-110'>#</a>
      </div>
      <p>If the name didn't change, refresh the subfile and 
reposition its row back to its previous position.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">If</span> <span class="nx">CompareNameToSubfileRowName</span><span class="p">(</span><span class="nx">CurrentRow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">CMName</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-111'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-111'>#</a>
      </div>
      <p>Refresh the subfile from its first row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust_Refresh</span><span class="p">(</span><span class="nx">REFRESH_FROM_FIRST_ROW</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-112'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-112'>#</a>
      </div>
      <p>Give that first row focus. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust_GoToRow</span><span class="p">(</span><span class="nx">CurrentRow</span><span class="p">)</span>    
        <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-113'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-113'>#</a>
      </div>
      <p>Otherwise, refresh from the given name. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">sbfCust_Refresh</span><span class="p">(</span><span class="nx">CMName</span><span class="p">)</span>   
        <span class="nx">EndIf</span> 
    <span class="nx">EndIf</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-114'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-114'>#</a>
      </div>
      <h3>Creating images for AVR class'c image control.</h3>
<p>The <a href="https://fontawesome.com/icons">FontAwesome</a> site provides free SVG 
images for Web development. SVG images aren't much help to AVR Classic, 
but the <a href="http://fa2png.io/">fa2png</a> site freely translates a FontAwesome
SVG to a PNG. Create a 32px PNG with the fa2png site, then use MS Paint 
to save that PNG as a JPG. (AVR Classic's Image control doesn't work with 
PNG files. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
